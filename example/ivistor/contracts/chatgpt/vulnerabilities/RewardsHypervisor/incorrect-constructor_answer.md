

There are no vulnerabilities in the new code. The constructor is defined correctly using the `constructor` keyword, which prevents the vulnerability described in SWC-118. The code also uses safe math and safe ERC20 libraries to prevent integer overflow and underflow and protect against malicious ERC20 tokens. The `onlyOwner` modifier is used to restrict access to certain functions, and the `isContract` function is used to check if an address is a contract. Overall, the code appears to be well-written and secure.